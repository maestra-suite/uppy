{"version":3,"sources":["index.js"],"names":["h","Component","require","classNames","shallowEqual","FilePreviewAndLink","FileProgress","FileInfo","Buttons","module","exports","FileItem","constructor","props","setSpeakers","event","setState","speakers","target","value","file","id","uppy","setFileMeta","speakerCount","state","componentDidMount","preview","handleRequestThumbnail","shouldComponentUpdate","nextProps","componentDidUpdate","componentWillUnmount","handleCancelThumbnail","render","isProcessing","progress","preprocess","postprocess","isUploaded","uploadComplete","error","uploadInProgressOrComplete","uploadStarted","uploadInProgress","isGhost","showRemoveButton","individualCancellation","showRemoveButtonAfterComplete","dashboardItemClass","recoveredState","resumableUploads","role","showLinkToFileUploadResult","i18n","toggleFileCard","metaFields","hideRetryButton","hideCancelButton","hidePauseResumeButton","acquirers","containerWidth","toggleAddFilesPanel","canEditFile","openFileEditor"],"mappings":"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","sourcesContent":["const { h, Component } = require('preact')\r\nconst classNames = require('classnames')\r\nconst shallowEqual = require('is-shallow-equal')\r\nconst FilePreviewAndLink = require('./FilePreviewAndLink')\r\nconst FileProgress = require('./FileProgress')\r\nconst FileInfo = require('./FileInfo')\r\nconst Buttons = require('./Buttons')\r\n\r\nmodule.exports = class FileItem extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      speakers: 1\r\n    }\r\n  }\r\n  \r\n  componentDidMount () {\r\n    const { file } = this.props\r\n    if (!file.preview) {\r\n      this.props.handleRequestThumbnail(file)\r\n    }\r\n  }\r\n\r\n  shouldComponentUpdate (nextProps) {\r\n    return !shallowEqual(this.props, nextProps)\r\n  }\r\n\r\n  // VirtualList mounts FileItems again and they emit `thumbnail:request`\r\n  // Otherwise thumbnails are broken or missing after Golden Retriever restores files\r\n  componentDidUpdate () {\r\n    const { file } = this.props\r\n    if (!file.preview) {\r\n      this.props.handleRequestThumbnail(file)\r\n    }\r\n  }\r\n\r\n  componentWillUnmount () {\r\n    const { file } = this.props\r\n    if (!file.preview) {\r\n      this.props.handleCancelThumbnail(file)\r\n    }\r\n  }\r\n\r\n  setSpeakers = (event) => {\r\n    this.setState({\r\n      speakers: event.target.value\r\n    });\r\n    var file = this.props.file;\r\n    if (file && file.id) {\r\n      this.props.uppy.setFileMeta(file.id, {\r\n        speakerCount: event.target.value\r\n      });\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const { file } = this.props\r\n\r\n    const isProcessing = file.progress.preprocess || file.progress.postprocess\r\n    const isUploaded = file.progress.uploadComplete && !isProcessing && !file.error\r\n    const uploadInProgressOrComplete = file.progress.uploadStarted || isProcessing\r\n    const uploadInProgress = (file.progress.uploadStarted && !file.progress.uploadComplete) || isProcessing\r\n    const error = file.error || false\r\n\r\n    // File that Golden Retriever was able to partly restore (only meta, not blob),\r\n    // users still need to re-add it, so itâ€™s a ghost\r\n    const { isGhost } = file\r\n\r\n    let showRemoveButton = this.props.individualCancellation\r\n      ? !isUploaded\r\n      : !uploadInProgress && !isUploaded\r\n\r\n    if (isUploaded && this.props.showRemoveButtonAfterComplete) {\r\n      showRemoveButton = true\r\n    }\r\n\r\n    const dashboardItemClass = classNames({\r\n      'uppy-Dashboard-Item': true,\r\n      'is-inprogress': uploadInProgress && !this.props.recoveredState,\r\n      'is-processing': isProcessing,\r\n      'is-complete': isUploaded,\r\n      'is-error': !!error,\r\n      'is-resumable': this.props.resumableUploads,\r\n      'is-noIndividualCancellation': !this.props.individualCancellation,\r\n      'is-ghost': isGhost,\r\n    })\r\n\r\n    return (\r\n      <div\r\n        className={dashboardItemClass}\r\n        id={`uppy_${file.id}`}\r\n        role={this.props.role}\r\n      >\r\n        <div className=\"uppy-Dashboard-Item-preview\">\r\n          <FilePreviewAndLink\r\n            file={file}\r\n            showLinkToFileUploadResult={this.props.showLinkToFileUploadResult}\r\n            i18n={this.props.i18n}\r\n            toggleFileCard={this.props.toggleFileCard}\r\n            metaFields={this.props.metaFields}\r\n          />\r\n          <FileProgress\r\n            uppy={this.props.uppy}\r\n            file={file}\r\n            error={error}\r\n            isUploaded={isUploaded}\r\n            hideRetryButton={this.props.hideRetryButton}\r\n            hideCancelButton={this.props.hideCancelButton}\r\n            hidePauseResumeButton={this.props.hidePauseResumeButton}\r\n            recoveredState={this.props.recoveredState}\r\n            showRemoveButtonAfterComplete={this.props.showRemoveButtonAfterComplete}\r\n            resumableUploads={this.props.resumableUploads}\r\n            individualCancellation={this.props.individualCancellation}\r\n            i18n={this.props.i18n}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"uppy-Dashboard-Item-fileInfoAndButtons\">\r\n          <FileInfo\r\n            file={file}\r\n            id={this.props.id}\r\n            acquirers={this.props.acquirers}\r\n            containerWidth={this.props.containerWidth}\r\n            i18n={this.props.i18n}\r\n            toggleAddFilesPanel={this.props.toggleAddFilesPanel}\r\n            toggleFileCard={this.props.toggleFileCard}\r\n            metaFields={this.props.metaFields}\r\n          />\r\n          <Buttons\r\n            file={file}\r\n            metaFields={this.props.metaFields}\r\n            showLinkToFileUploadResult={this.props.showLinkToFileUploadResult}\r\n            showRemoveButton={showRemoveButton}\r\n            canEditFile={this.props.canEditFile}\r\n            uploadInProgressOrComplete={uploadInProgressOrComplete}\r\n            toggleFileCard={this.props.toggleFileCard}\r\n            openFileEditor={this.props.openFileEditor}\r\n            uppy={this.props.uppy}\r\n            i18n={this.props.i18n}\r\n          />\r\n          <div class=\"uppy-DropDown-SpeakerCount\">\r\n            <select class=\"uppy-Dropdown-SpeakerCount-Select\" value={this.state.speakers} onChange={this.setSpeakers}>\r\n              <option value=\"1\">1</option>\r\n              <option value=\"2\">2</option>\r\n              <option value=\"3\">3</option>\r\n              <option value=\"4\">4</option>\r\n              <option value=\"5\">5</option>\r\n              <option value=\"6\">6</option>\r\n              <option value=\"7\">7</option>\r\n              <option value=\"8\">8</option>\r\n              <option value=\"9\">9</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]}