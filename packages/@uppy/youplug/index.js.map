{"version":3,"sources":["index.js"],"names":["UIPlugin","require","h","axios","UIScreen","PermScreen","locale","GTAP","GAPI","module","exports","Youplug","constructor","uppy","opts","type","id","title","provider","credentials","icon","clientConfig","clientId","web","client_id","permConfig","discoveryDocs","scope","redirect_uris","cookie_policy","setState","user","videos","selectedVideo","selectedLang","authed","modalOpen","permOK","gapiReady","mountedReady","activeToken","prevToken","nextToken","defaultLocale","defaultOptions","i18nInit","install","bind","uninstall","onMount","onSignInX","stateVideos","afterModalOpened","afterModalClosed","render","logout","retriever","target","mount","console","log","unmount","base64urlDecode","str","Buffer","base64urlUnescape","toString","Array","length","join","replace","onGapiLoad","window","gapi","load","getState","metatag","document","createElement","setAttribute","getElementsByTagName","appendChild","scriptGAPI","defer","async","src","onload","event","body","scriptGTAP","on","onSubmit","e","preventDefault","formData","FormData","append","props","code","tokens","uid","state","theFile","post","then","res","gRes","segments","credential","split","Error","headerSeg","payloadSeg","signatureSeg","header","JSON","parse","payload","response","token","signature","aud","iss","auth2","authorize","apiKey","prompt","response_type","immediate","login_hint","email","authorizeResult","error","alert","pagingFlag","client","init","getChannelList","getUploadedList","result","items","pageInfo","totalResults","resultsPerPage","nextPageToken","prevPageToken","getCaptionList","catch","dir","youtube","channels","list","channelId","uploadsId","contentDetails","relatedPlaylists","uploads","baseReq","pageReq","playlistItems","crunchCaptions","capSet","caps","idx","snippet","language","stringify","playList","vidx","pita","videoId","thumbnails","default","url","medium","videoPublishedAt","status","privacyStatus","push","incoming","auth","signOut","listPlugins","iteratePlugins","cur","index","arr","dash","getPlugin","parent","el","addTarget","i18n","account_id","VERSION","TheIcon","width","height","viewBox","xmlns","className","d","fill"],"mappings":"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","sourcesContent":["const { UIPlugin } = require('@uppy/core');\nconst { h } = require('preact');\nconst axios = require('axios');\nconst UIScreen = require('./ui.js');\nconst PermScreen = require('./perm.js');\nconst locale = require('./locale.js');\nconst GTAP = \"https://accounts.google.com/gsi/client\";\nconst GAPI = \"https://apis.google.com/js/client:platform.js\";\n\n/**\n * Youplug\n */\nmodule.exports = class Youplug extends UIPlugin {\n  static VERSION = require('../package.json').version\n\n  constructor(uppy, opts) {\n    super(uppy, opts);\n    this.type = 'acquirer';\n    this.uppy = uppy;\n    this.id = this.opts.id || 'Youplug';\n    this.title = this.opts.title || 'Youplug';\n    this.provider = \"youtube\";\n    this.credentials = opts.credentials;\n    this.icon = () => <TheIcon />\n\n    this.clientConfig = {\n      'cookie_policy': 'single_host_origin',\n      'discoveryDocs': 'https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest',\n      'scope': 'profile email https://www.googleapis.com/auth/youtubepartner https://www.googleapis.com/auth/youtube.upload'\n    };\n    this.clientConfig.clientId = this.credentials.web.client_id;\n    this.permConfig = {\n      'client_id': this.credentials.web.client_id,\n      'discoveryDocs': this.clientConfig.discoveryDocs,\n      'apiKey': 'AIzaSyDYKgIZni9Jm-qbu4pMuOxaB6899RFu6dY',\n      'scope': this.clientConfig.scope,\n      'ux_mode': 'popup',\n      'fetch_basic_profile': true,\n      'redirect_uri': this.credentials.web.redirect_uris[0],\n      'cookie_policy': this.clientConfig.cookie_policy\n    }\n    this.uppy.setState({\n      user: '',\n      videos: null,\n      selectedVideo: '',\n      selectedLang: 'en',\n      authed: false,\n      modalOpen: false,\n      permOK: false,\n      gapiReady: false,\n      mountedReady: false,\n      activeToken: null,\n      prevToken: '',\n      nextToken: ''\n    });\n\n    // Set default options and locale\n    this.defaultLocale = locale\n\n    const defaultOptions = {\n      type: 'acquirer',\n      id: this.id,\n      title: this.title\n    }\n\n    this.opts = { ...defaultOptions, ...opts }\n    this.i18nInit()\n\n    this.install = this.install.bind(this);\n    this.uninstall = this.uninstall.bind(this);\n    this.onMount = this.onMount.bind(this);\n    this.onSignInX = this.onSignInX.bind(this);\n    this.stateVideos = this.stateVideos.bind(this);\n    this.afterModalOpened = this.afterModalOpened.bind(this);\n    this.afterModalClosed = this.afterModalClosed.bind(this);\n    this.render = this.render.bind(this);\n    this.logout = this.logout.bind(this);\n    this.retriever = this.retriever.bind(this);\n  }\n\n  install() {\n    if (this.target) {\n      this.mount(this.target, this)\n    }\n    this.onMount();\n    console.log('onInstall')\n  }\n\n  uninstall() {\n    this.unmount()\n  }\n\n  base64urlDecode(str) {\n    return new Buffer(this.base64urlUnescape(str), 'base64').toString();\n  }\n\n  base64urlUnescape(str) {\n    str += Array(5 - str.length % 4).join('=');\n    return str.replace(/\\-/g, '+').replace(/_/g, '/');\n  }\n\n  onGapiLoad() {\n    window.gapi.load('client');\n  }\n\n  onMount() {\n    if (!this.uppy.getState().gapiReady) {\n//      console.log('onMount once');\n\n      const metatag = document.createElement('script');\n      metatag.setAttribute('name', 'google-signin-client_id');\n      metatag.setAttribute('content', this.credentials.web.client_id);\n      document.getElementsByTagName('head')[0].appendChild(metatag);\n\n      const scriptGAPI = document.createElement('script');\n      scriptGAPI.defer = true;\n      scriptGAPI.async = true;\n      scriptGAPI.src = GAPI;\n      scriptGAPI.onload = (event) => this.onGapiLoad();\n      document.body.appendChild(scriptGAPI);\n\n      const scriptGTAP = document.createElement('script');\n      scriptGTAP.defer = true;\n      scriptGTAP.async = true;\n      scriptGTAP.src = GTAP;\n      //      script.onload = (event) => this.onGapiLoad();\n      document.body.appendChild(scriptGTAP);\n\n      this.uppy.on('dashboard:modal-open', () => this.afterModalOpened());\n      this.uppy.on('dashboard:modal-closed', () => this.afterModalClosed());\n\n      this.uppy.setState({ gapiReady: true })\n    }\n  }\n\n  onSubmit(e) {\n    e.preventDefault();\n    const formData = new FormData();\n    formData.append('lang', 'en');\n    formData.append('code', this.props.code);\n    formData.append('tokens', this.props.tokens);\n    formData.append('uid', this.props.uid);\n    formData.append('id', 'hf0YXTefxj8');\n    formData.append('theFile', this.state.theFile);\n    axios.post(\"http://localhost:3000/api/captions/set\", formData, {\n\n    }).then(res => {\n//      console.log(res)\n    })\n  }\n\n  onSignInX(gRes) {\n    var segments = gRes.credential.split('.');\n\n    if (segments.length !== 3) {\n      throw new Error('Not enough or too many segments');\n    }\n\n    // All segment should be base64\n    var headerSeg = segments[0];\n    var payloadSeg = segments[1];\n    var signatureSeg = segments[2];\n\n    // base64 decode and parse JSON\n    var header = JSON.parse(this.base64urlDecode(headerSeg));\n    var payload = JSON.parse(this.base64urlDecode(payloadSeg));\n\n    const response = {\n      token: gRes.credential,\n      header: header,\n      payload: payload,\n      signature: signatureSeg\n    };\n\n    console.log('ClientID check ' + ((response.payload.aud === this.permConfig.client_id) ? 'is ok.' : 'has failed.'));\n    console.log('ISS check ' + ((response.payload.iss === 'https://accounts.google.com' || response.payload.iss === 'accounts.google.com') ? 'is ok.' : 'has failed.'));\n    window.gapi.auth2.authorize({\n      apiKey: this.permConfig.apiKey,\n      client_id: this.credentials.web.client_id,\n      prompt: 'none',\n      response_type: 'permission id_token token code', // Access Token.\n      scope: this.clientConfig.scope,\n      immediate: true,\n      login_hint: gRes.credential.email\n    }, authorizeResult => {\n      if (authorizeResult.error === 'immediate_failed') {\n        alert('You need to select user to successfully authorize this application to continue.');\n      } else if (authorizeResult.error === 'popup_closed_by_user') {\n        alert('The authorization popup shouldnt be blocked or closed to function properly.');\n      } else if (authorizeResult.error === 'access_denied') {\n        alert('You denied the permission to the scopes required by the authorization flow.');\n      } else if(authorizeResult.error === 'idpiframe_initialization_failed') {\n        alert('Sorry, you are using an unsupported environment.')\n      }\n\n      // return;\n      // const options = new gapi.auth2.SigninOptionsBuilder();\n      // options.setPrompt('select_account');\n\n      this.retriever();\n    });\n  }\n\n  retriever() {\n      let pagingFlag = false;\n      window.gapi.client.init({\n        'apiKey': this.permConfig.apiKey,\n        'discoveryDocs': [this.clientConfig.discoveryDocs]\n      }).then(() => this.getChannelList())\n        .then(response => this.getUploadedList(response.result.items))\n        .then(response => {\n          pagingFlag = (response.result.pageInfo.totalResults > response.result.pageInfo.resultsPerPage) ? true : false;\n          return response;\n        })\n        .then(response => {\n          if(response.result.nextPageToken){\n            this.uppy.setState({ nextToken: response.result.nextPageToken });\n          }\n          if(response.result.prevPageToken){\n            this.uppy.setState({ prevToken: response.result.prevPageToken });\n          }\n          return response;\n        })\n        .then(response => this.getCaptionList(response.result.items))\n        .then(videos => this.stateVideos(videos))\n        .catch(e => console.dir(e));\n  }\n\n\n  getChannelList() {\n    const res = window.gapi.client.youtube.channels.list({\n      'mine': true,\n      'part': 'snippet,contentDetails,statistics',\n      'maxResults': 50\n    });\n    return res;\n  }\n\n  getUploadedList(items) {\n    const channelId = items[0].id;\n    console.log('channel id is:' + channelId);\n    const uploadsId = items[0].contentDetails.relatedPlaylists.uploads;\n    console.log('uploads channel id is:' + uploadsId);\n\n    const baseReq = {\n      'playlistId': uploadsId,\n      'part': 'id,contentDetails,snippet,status',\n      'maxResults': 2\n    }\n    const pageReq = this.uppy.getState().activeToken ?\n      { 'pageToken': this.uppy.getState().activeToken } : {};\n      return window.gapi.client.youtube.playlistItems.list({...baseReq, ...pageReq});\n  }\n\n  crunchCaptions(capSet) {\n    let caps = {};\n    for (let idx in capSet.result.items) {\n      caps[capSet.result.items[idx].snippet.language] = capSet.result.items[idx].id;\n    }\n    return JSON.stringify(caps);\n  }\n\n  getCaptionList(items) {\n    let playList = [];\n    for (let vidx in items) {\n      const pita = {\n        'vdId': items[vidx].contentDetails.videoId,\n        'tmbd': items[vidx].snippet.thumbnails.default.url,\n        'tmbm': items[vidx].snippet.thumbnails.medium.url,\n        'titl': items[vidx].snippet.title,\n        'date': items[vidx].contentDetails.videoPublishedAt,\n        'stat': items[vidx].status.privacyStatus,\n        //            'cpts': enced\n      };\n      playList.push(pita);\n    }      // end of for in ... responsePlId.result.items\n    return playList;\n  }\n\n  stateVideos(incoming) {\n    this.uppy.setState({ authed: true, videos: incoming });\n  }\n\n  logout(e) {\n    console.log('ARRIVED');\n    e.preventDefault();\n    this.gapi.auth2.init(this.permConfig).then(auth => {\n      auth.signOut();\n      this.uppy.setState({\n        user: '',\n        videos: null,\n        authed: false,\n        modalOpen: false,\n        permOK: false,\n        prevToken: '',\n        nextToken: ''\n      });\n      this.uppy.logout();\n      //      this.forceUpdate();\n    });\n  }\n\n  listPlugins() {\n    this.uppy.iteratePlugins((cur, index, arr) => console.dir(cur));\n  }\n\n  afterModalOpened() {\n    const dash = this.uppy.getPlugin('react:DashboardModal') || this.uppy.getPlugin('react:Dashboard') || this.uppy.getPlugin('Dashboard')\n    if (dash && !this.uppy.getState().mountedReady) {\n      this.parent = dash;\n      this.el = dash.addTarget(this.uppy.getPlugin(this.id));\n      this.onMount();\n      this.uppy.setState({ 'mountedReady': true });\n    }\n  }\n\n  afterModalClosed() {\n    this.uppy.setState({ authed: false });\n    console.log('onModal close')\n  }\n\n  render() {\n    return (this.uppy.getState().authed) ?\n      (<UIScreen\n        i18n={this.i18n}\n        logout={this.logout}\n        uppy={this.uppy}\n        retriever={this.retriever}\n        prev={this.uppy.getState().prevToken}\n        next={this.uppy.getState().nextToken}\n      />) : (<PermScreen\n        i18n={this.i18n}\n        cid={this.permConfig.client_id}\n        onSignIn={this.onSignInX}\n        account_id={this.account_id}\n      />)\n  }\n\n}\nfunction TheIcon() {\n  return h(\"svg\", {\n    width: \"300\",\n    height: \"300\",\n    viewBox: \"0 0 300 300\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    className: \"uppy-Youplug-icon\"\n  },\n    h(\"path\", {\n      d: \"M 149.9375 79.222656 C 149.9375 79.222656 86.718651 79.222715 70.851562 83.345703 C 62.355775 85.719505 55.360154 92.715203 52.986328 101.33594 C 48.863375 117.20304 48.863281 150.0625 48.863281 150.0625 C 48.863281 150.0625 48.863375 183.0467 52.986328 198.66406 C 55.360154 207.28468 62.230834 214.15544 70.851562 216.5293 C 86.843592 220.77718 149.9375 220.77734 149.9375 220.77734 C 149.9375 220.77734 213.28168 220.77729 229.14844 216.6543 C 237.76923 214.28049 244.63977 207.53464 246.88867 198.78906 C 251.1366 183.04674 251.13672 150.1875 251.13672 150.1875 C 251.13672 150.1875 251.26156 117.20304 246.88867 101.33594 C 244.63977 92.715203 237.76923 85.844606 229.14844 83.595703 C 213.28168 79.222856 149.9375 79.222656 149.9375 79.222656 z M 129.82227 119.70312 L 182.42188 150.0625 L 129.82227 180.29688 L 129.82227 119.70312 z\",\n      fill: \"white\"\n    }),\n  )\n}\n\n"]}